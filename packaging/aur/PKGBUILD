# Maintainer: blitzkriegfc <blitzkriegfc@proton.me>
pkgname=qbz-bin
pkgver=1.0.0
pkgrel=1
pkgdesc="Native Qobuz client for Linux with Hi-Fi audio support (pre-built binary)"
arch=('x86_64')
url="https://github.com/vicrodh/qbz"
license=('MIT')
depends=('webkit2gtk-4.1' 'gtk3' 'alsa-lib' 'libappindicator-gtk3')
optdepends=(
    'pipewire-alsa: PipeWire audio support'
    'pipewire-pulse: PulseAudio compatibility'
)
provides=('qbz')
conflicts=('qbz')
options=('!strip')
source=("${pkgname}-${pkgver}.tar.gz::https://github.com/vicrodh/qbz/releases/download/v${pkgver}/qbz_${pkgver}_amd64.tar.gz")
sha256sums=('SKIP')

package() {
    cd "${srcdir}"

    # Install binary
    install -Dm755 "qbz" "${pkgdir}/usr/bin/qbz"

    # Install desktop file
    install -Dm644 "qbz.desktop" "${pkgdir}/usr/share/applications/qbz.desktop"

    # Install icons
    for size in 32x32 128x128 256x256; do
        if [[ -f "icons/hicolor/${size}/apps/qbz.png" ]]; then
            install -Dm644 "icons/hicolor/${size}/apps/qbz.png" \
                "${pkgdir}/usr/share/icons/hicolor/${size}/apps/qbz.png"
        fi
    done

    # Install license
    install -Dm644 "${srcdir}/../LICENSE" "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE" 2>/dev/null || true
}
